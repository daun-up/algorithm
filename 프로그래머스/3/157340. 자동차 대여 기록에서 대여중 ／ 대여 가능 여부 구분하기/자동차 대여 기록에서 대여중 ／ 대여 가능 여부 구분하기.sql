-- 코드를 입력하세요
SELECT CAR_ID,
# CASE WHEN START_DATE <= DATE('2022-10-16') AND DATE('2022-10-16') <= END_DATE
# THEN '대여 가능' ELSE '대여중' END AS AVAILABILITY
CASE
# WHEN '2022-10-16' BETWEEN START_DATE - 1 AND END_DATE + 1
# WHEN MAX(START_DATE <= DATE('2022-10-16') AND DATE('2022-10-16') <= END_DATE)

# WHEN '2022-10-16' BETWEEN START_DATE AND END_DATE
WHEN MAX(START_DATE <= DATE('2022-10-16') AND END_DATE >= DATE('2022-10-16')) = 1
THEN '대여중' ELSE '대여 가능'
END AS AVAILABILITY
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
GROUP BY CAR_ID
ORDER BY CAR_ID DESC;

# 여러 개의 대여 이력이 있으므로, 2022-10-16 일에 대여중인 거, 아닌 거가 있어도 대여 중이라고 해야함